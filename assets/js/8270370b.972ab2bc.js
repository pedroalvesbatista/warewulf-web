"use strict";(self.webpackChunkwarewulf=self.webpackChunkwarewulf||[]).push([[8283],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return f}});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=o.createContext({}),d=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},u=function(e){var n=d(e.components);return o.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},p=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=d(t),f=r,m=p["".concat(s,".").concat(f)]||p[f]||c[f]||i;return t?o.createElement(m,a(a({ref:n},u),{},{components:t})):o.createElement(m,a({ref:n},u))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,a[1]=l;for(var d=2;d<i;d++)a[d]=t[d];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}p.displayName="MDXCreateElement"},3189:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return u},default:function(){return p}});var o=t(7462),r=t(3366),i=(t(7294),t(3905)),a=["components"],l={id:"nodeconfig",title:"Node Configuration"},s=void 0,d={unversionedId:"enchiridion/nodeconfig",id:"enchiridion/nodeconfig",isDocsHomePage:!1,title:"Node Configuration",description:"The Node Configuration DB",source:"@site/docs/enchiridion/nodeconfig.md",sourceDirName:"enchiridion",slug:"/enchiridion/nodeconfig",permalink:"/docs/enchiridion/nodeconfig",editUrl:"https://github.com/hpcng/warewulf-web/edit/main/docs/enchiridion/nodeconfig.md",tags:[],version:"current",frontMatter:{id:"nodeconfig",title:"Node Configuration"},sidebar:"someSidebar",previous:{title:"Kernel Management",permalink:"/docs/enchiridion/kernel"},next:{title:"Node Profiles",permalink:"/docs/enchiridion/profiles"}},u=[{value:"The Node Configuration DB",id:"the-node-configuration-db",children:[]},{value:"Adding a New Node",id:"adding-a-new-node",children:[{value:"Node Names",id:"node-names",children:[]}]},{value:"Listing Nodes",id:"listing-nodes",children:[]},{value:"Setting Node Attributes",id:"setting-node-attributes",children:[{value:"Configuring the Node&#39;s Container Image",id:"configuring-the-nodes-container-image",children:[]},{value:"Configuring the Node&#39;s Kernel",id:"configuring-the-nodes-kernel",children:[]},{value:"Configuring the Node&#39;s Network",id:"configuring-the-nodes-network",children:[]}]},{value:"Un-setting Node Attributes",id:"un-setting-node-attributes",children:[]}],c={toc:u};function p(e){var n=e.components,t=(0,r.Z)(e,a);return(0,i.kt)("wrapper",(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"the-node-configuration-db"},"The Node Configuration DB"),(0,i.kt)("p",null,"As mentioned in the ",(0,i.kt)("a",{parentName:"p",href:"configuration"},"Configuration")," section, node configs are persisted to the ",(0,i.kt)("inlineCode",{parentName:"p"},"nodes.conf")," YAML file but generally it is best not to edit this file directly (however that is supported, it is just prone to errors)."),(0,i.kt)("p",null,"This method of using a YAML configuration file as a backend datastore is both scalable and very lightweight. We've tested this out to over 10,000 node entries which yielded update latencies under 1 second, which we felt was both tolerable and advantageous."),(0,i.kt)("h2",{id:"adding-a-new-node"},"Adding a New Node"),(0,i.kt)("p",null,"Creating a new node is as simple as running the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node add n0000\nAdded node: n0000\n")),(0,i.kt)("h3",{id:"node-names"},"Node Names"),(0,i.kt)("p",null,"For small clusters, you can use simple names (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"n0000"),") but for larger, more complicated clusters that are compromised of multiple clusters and roles, it is highly recommended to use node names that include a cluster descriptor. In Warewulf, this is generally done by using a domain name (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"n0000.cluster01"),"). Warewulf will automatically assume that the domain is the equivalent of the cluster name."),(0,i.kt)("p",null,'This also means that you can address groups of nodes by the cluster descriptor with globs. For example, you are able to refer to all nodes in "cluster01" with the following string: ',(0,i.kt)("inlineCode",{parentName:"p"},"*.cluster01")," which is valuable for other ",(0,i.kt)("inlineCode",{parentName:"p"},"wwctl")," commands."),(0,i.kt)("h2",{id:"listing-nodes"},"Listing Nodes"),(0,i.kt)("p",null,"Once you have configured one or more nodes, you can list them and their attributes as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node list\nNODE NAME              PROFILES                   NETWORK\n================================================================================\nn0000                  default\n")),(0,i.kt)("p",null,"You can also see the node's full attribute list by specifying the ",(0,i.kt)("inlineCode",{parentName:"p"},"-a")," option (all):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node list -a\n################################################################################\nNODE                 FIELD              PROFILE      VALUE\nn0000                Id                 --           n0000\nn0000                Comment            default      This profile is automatically included for each node\nn0000                Cluster            --           --\nn0000                Profiles           --           default\nn0000                Discoverable       --           false\nn0000                Container          --           --\nn0000                Kernel             --           --\nn0000                KernelArgs         --           (quiet crashkernel=no vga=791 rootfstype=rootfs)\nn0000                RuntimeOverlay     --           (default)\nn0000                SystemOverlay      --           (default)\nn0000                Ipxe               --           (default)\nn0000                Init               --           (/sbin/init)\nn0000                Root               --           (initramfs)\nn0000                IpmiIpaddr         --           --\nn0000                IpmiNetmask        --           --\nn0000                IpmiPort           --           --\nn0000                IpmiGateway        --           --\nn0000                IpmiUserName       --           --\nn0000                IpmiInterface      --           --\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"note: The attribute values in parenthesis are default values and can be overridden in the next section, granted, the default values are generally usable.")),(0,i.kt)("h2",{id:"setting-node-attributes"},"Setting Node Attributes"),(0,i.kt)("p",null,"In the above output we can see that there is no kernel or container defined for this node. To provision a node, the minimum requirements are a kernel and container, and for that node to be useful, we will also need to configure the network so the nodes are reachable after they boot."),(0,i.kt)("p",null,"Node configurations are set using the ",(0,i.kt)("inlineCode",{parentName:"p"},"wwctl node set")," command. To see a list of all configuration attributes, use the command ",(0,i.kt)("inlineCode",{parentName:"p"},"wwctl node set --help"),"."),(0,i.kt)("h3",{id:"configuring-the-nodes-container-image"},"Configuring the Node's Container Image"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node set --container rocky-8 n0000\nAre you sure you want to modify 1 nodes(s): y\n")),(0,i.kt)("p",null,"And you can check that the container name is set for ",(0,i.kt)("inlineCode",{parentName:"p"},"n0000"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node list -a  n0000 | grep Container\nn0000                Container          --           rocky-8\n")),(0,i.kt)("h3",{id:"configuring-the-nodes-kernel"},"Configuring the Node's Kernel"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node set --kernel $(uname -r) n0000\nAre you sure you want to modify 1 nodes(s): y\n\n$ sudo wwctl node list -a  n0000 | grep KernelVersion\nn0000                Kernel             --           4.18.0-305.3.1.el8_4.x86_64\n")),(0,i.kt)("h3",{id:"configuring-the-nodes-network"},"Configuring the Node's Network"),(0,i.kt)("p",null,"To configure the network, we have to pick a network device name and provide the network information as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node set --netdev eth0 --hwaddr 11:22:33:44:55:66 --ipaddr 10.0.2.1 --netmask 255.255.252.0 n0000\nAre you sure you want to modify 1 nodes(s): y\n")),(0,i.kt)("p",null,"You can now see that the node contains configuration attributes for container, kernel, and network:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node list -a n0000\n################################################################################\nNODE                 FIELD              PROFILE      VALUE\nn0000                Id                 --           n0000\nn0000                Comment            default      This profile is automatically included for each node\nn0000                Cluster            --           --\nn0000                Profiles           --           default\nn0000                Discoverable       --           false\nn0000                Container          --           rocky-8\nn0000                Kernel             --           4.18.0-305.3.1.el8_4.x86_64\nn0000                KernelArgs         --           (quiet crashkernel=no vga=791 rootfstype=rootfs)\nn0000                RuntimeOverlay     --           (default)\nn0000                SystemOverlay      --           (default)\nn0000                Ipxe               --           (default)\nn0000                Init               --           (/sbin/init)\nn0000                Root               --           (initramfs)\nn0000                IpmiIpaddr         --           --\nn0000                IpmiNetmask        --           --\nn0000                IpmiPort           --           --\nn0000                IpmiGateway        --           --\nn0000                IpmiUserName       --           --\nn0000                IpmiInterface      --           --\nn0000                eth0:HWADDR        --           11:22:33:44:55:66\nn0000                eth0:IPADDR        --           10.0.2.1\nn0000                eth0:NETMASK       --           255.255.252.0\nn0000                eth0:GATEWAY       --           --\nn0000                eth0:TYPE          --           --\nn0000                eth0:DEFAULT       --           false\n")),(0,i.kt)("h2",{id:"un-setting-node-attributes"},"Un-setting Node Attributes"),(0,i.kt)("p",null,"While we have a ",(0,i.kt)("inlineCode",{parentName:"p"},"set")," command we do not have an ",(0,i.kt)("inlineCode",{parentName:"p"},"unset")," command (however as of the time of this writing there is a ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/hpcng/warewulf/issues/35"},"GitHub issue")," requesting this)."),(0,i.kt)("p",null,"If you wish to ",(0,i.kt)("inlineCode",{parentName:"p"},"unset")," a particular value you have to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"UNDEF")," value as we did with previous versions of Warewulf. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node set --cluster cluster01 n0000\nAre you sure you want to modify 1 nodes(s): y\n\n$ sudo wwctl node list -a n0000 | grep Cluster\nn0000                Cluster            --           cluster01\n")),(0,i.kt)("p",null,"And to unset this configuration attribute:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo wwctl node set --cluster UNDEF n0000\nAre you sure you want to modify 1 nodes(s): y\n\n$ sudo wwctl node list -a n0000 | grep Cluster\nn0000                Cluster            --           --\n")))}p.isMDXComponent=!0}}]);